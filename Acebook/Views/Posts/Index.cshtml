@model acebook.Models.User
@using acebook.Models
@{
    var errorMessage = TempData["ErrorMessage"];
}

@if (errorMessage != null)
{
    <div class="alert alert-danger text-center">
        @errorMessage
    </div>
}

<div class="profile-buttons">
    @if (Context.Session.GetString("Username") == ViewBag.ProfileUserName)
    {
        <a href="@Url.Action("Profile", "Users", new { username = ViewBag.ProfileUserName })" class="btn btn-primary">Profile</a>
    }
    <form action="@Url.Action("Logout", "Sessions")" method="post" style="display:inline;">
        <button type="submit" class="btn btn-secondary">Logout</button>
    </form>
</div>

<div class="post-form">
    <img src="@(string.IsNullOrEmpty(ViewBag.CurrentUser?.profilePicture) ? "/images/default-profile.png" : ViewBag.CurrentUser.profilePicture)" 
        alt="User Profile Picture" class="profile-pic" />

    <form action="/posts" method="post" enctype="multipart/form-data">
        <div class="input-container">
            <input type="text" id="PostText" name="PostText" placeholder="What's on your mind?" class="post-input" />
        </div>

        <div class="image-upload">
            <label for="PostImageUrl"></label>
            <input type="text" id="PostImageUrl" name="PostImageUrl" placeholder="Enter image URL" class="image-input" />
            <span>or</span>
            <input type="file" id="PostImageFile" name="PostImageFile" class="file-input" />
            <button type="submit" class="post-btn">Post</button>
        </div>
    </form>
</div>

@foreach (Post post in ViewBag.Posts)
{
    <div class="post-container">
      
        <div class="user-info">
            <img src="@(string.IsNullOrEmpty(post.User?.profilePicture) ? "/images/default-profile.png" : post.User.profilePicture)" 
                alt="User Profile Picture" class="profile-pic" />
            <p class="user-name">@post.User?.Name</p>
        </div>

    
        <div class="post-content">
            <p class="post-text">@post.PostText</p>

            @if (!string.IsNullOrEmpty(post.PostImage))
            {
                <img src="@post.PostImage" alt="Post Image" class="post-image" />
            }

            <p class="post-meta-date">Posted on: @post.CreatedAt.ToString("dd MMM yyyy, HH:mm")</p>

        </div>

        <div class="reactions">
            <div class="like-count">
                <span>0</span> 
            </div>
            <div class="comment-count">
                <span>0</span> 
            </div>
        </div>
    </div>
}
